{% extends 'base.html' %}
{% block title %}系统用户管理{% endblock %}
{% block content %}
<div class="row">
  <div class="col-sm-4 col-md-3">
    <h4>新增用户</h4>
    <form method="post" action="{{ url_for('system.create_user') }}">
      <div class="form-group">
        <label>用户名</label>
        <input type="text" name="username" class="form-control" required>
      </div>
      <div class="form-group">
        <label>密码</label>
        <input type="password" name="password" class="form-control" required>
      </div>
      <div class="form-group">
        <label>级别</label>
        <select name="level" class="form-control">
          <option value="operator">操作用户</option>
          <option value="admin">管理员</option>
        </select>
      </div>
      <button type="submit" class="btn btn-primary btn-block">保存</button>
    </form>
  </div>
  <div class="col-sm-8 col-md-9">
    <h4>用户列表</h4>
    <table class="table table-striped table-condensed table-hover">
      <thead>
        <tr>
          <th>用户名</th>
          <th>级别</th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
        <tr>
          <td>{{ user.username }}</td>
          <td>{{ '管理员' if user.level == 'admin' else '操作用户' }}</td>
          <td>
            <form method="post" action="{{ url_for('system.update_user', user_id=user.id) }}" class="form-inline" style="display:inline-block">
              <select name="level" class="form-control input-sm">
                <option value="operator" {% if user.level == 'operator' %}selected{% endif %}>操作用户</option>
                <option value="admin" {% if user.level == 'admin' %}selected{% endif %}>管理员</option>
              </select>
              <input type="password" name="password" class="form-control input-sm" placeholder="新密码">
              <button type="submit" class="btn btn-xs btn-primary">更新</button>
            </form>
            <form method="post" action="{{ url_for('system.reset_password', user_id=user.id) }}" style="display:inline" onsubmit="return confirm('确认重置密码?');">
              <button type="submit" class="btn btn-xs btn-warning">重置密码</button>
            </form>
            <form method="post" action="{{ url_for('system.delete_user', user_id=user.id) }}" style="display:inline" onsubmit="return confirm('确认删除?');">
              <button type="submit" class="btn btn-xs btn-danger">删除</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
