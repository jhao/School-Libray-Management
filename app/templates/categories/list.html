{% extends 'base.html' %}
{% block title %}分类列表{% endblock %}
{% block content %}
<div class="page-header">
  <h2>分类列表</h2>
  <div class="header-actions">
    <a class="btn btn-primary" href="{{ url_for('categories.create_category') }}">新增分类</a>
    <a class="btn btn-default" href="{{ url_for('categories.bulk_edit_categories') }}">批量修改</a>
  </div>
</div>
<table class="table table-striped table-condensed table-hover category-tree-table">
  <thead>
    <tr>
      <th>分类名称</th>
      <th class="text-center" style="width: 120px;">排序</th>
      <th class="text-right" style="width: 120px;">操作</th>
    </tr>
  </thead>
  <tbody>
    {% if category_rows %}
      {% for item in category_rows %}
      {% set category = item.category %}
      <tr>
        <td class="category-name-cell">
          <span class="tree-label{% if item.has_children %} has-children{% endif %}" style="margin-left: {{ item.depth * 18 }}px;">{{ category.name }}</span>
        </td>
        <td class="text-center">{{ category.sort }}</td>
        <td class="text-right">
          <a class="btn btn-xs btn-default" href="{{ url_for('categories.edit_category', category_id=category.id) }}">编辑</a>
          {% if current_user.level == 'admin' %}
          <form method="post" action="{{ url_for('categories.delete_category', category_id=category.id) }}" style="display:inline" onsubmit="return confirm('确认删除?');">
            <button type="submit" class="btn btn-xs btn-danger">删除</button>
          </form>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    {% else %}
    <tr>
      <td colspan="3" class="text-center text-muted">暂无数据</td>
    </tr>
    {% endif %}
  </tbody>
</table>
{% endblock %}
